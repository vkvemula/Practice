<!-- @author Manish. Please consult in case of any isssue, mk131288@gmail.com -->
        <apex:page controller="ElearningLandingController" docType="HTML-5.0" showHeader="false" sidebar="false" standardStylesheets="false" id="pageId" >

            <apex:includeScript value="{!$Resource.jQuery}"/>
            <apex:includeScript value="{!URLFOR($Resource.bootstrap, 'js/bootstrap.js')}"/>
            <apex:includeScript value="{!URLFOR($Resource.bootstrap, 'js/bootstrap-tooltip.js')}"/>
            <apex:includeScript value="{!URLFOR($Resource.tooltipster, 'js/jquery.tooltipster.js')}"/>
            <apex:includeScript value="{!URLFOR($Resource.jqueryui, 'js/jquery-ui.js')}"/>
            <!-- <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script> -->
            
            <apex:stylesheet value="{!URLFOR($Resource.bootstrap, 'css/bootstrap.css')}"/>
            <apex:stylesheet value="{!URLFOR($Resource.tooltipster, 'css/tooltipster.css')}"/>
            <apex:stylesheet value="{!URLFOR($Resource.jqueryui, 'css/jquery-ui.css')}"/>
            <!-- <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" /> -->
            
            <script>
                $(function(){
                    resizeDiv();
                });
                
                window.onresize = function(event) {
                    resizeDiv();
                }
                
                function resizeDiv() {
                    vpw = $(window).width();
                    vph = $(window).height();
                    var upperDivHeight = $('#upperDiv').height();
                    
                    var newHeight = vph - (upperDivHeight + 30);
                    $('div.workSpace').css({'height': newHeight + 'px'});
                }
            </script>

            <style>
            
                
                div.workSpace{
                    border-top: 4px solid #555;
                    margin: 1px;
                    height: 100%;
                }
            
                .upperSection table tr{
                    vertical-align:top;
                }
                
                .eLearnButton{
                    margin:3px 1px;
                    box-shadow: 2px 2px 1px #000;
                    width:100%;
                }
                
                #upperSectionFrameTable{
                    border-spacing:2px;
                    border-collapse:collapse;
                }
            
                div.upperSection{
                    margin-top:10px;
                    padding: 0 1%;
                }
                
                div.taskButtonClass, div.exerciseButtonClass{
                    border-top:1px solid #AAA;
                    padding:5px;
                    /* position : absolute; */
                    bottom:5px;
                    left:10px;
                    right:10px;
                }
                
                #detailsTable{
                    width:100%;
                }
                
                .currentTaskRow{
                    color:#1D7824;
                    font-style:italic;
                    font-weight:bold;
                }
                
                .completedTaskRow{
                    color:#0B148C;
                }
                
                #cell-logo{
                    width: 80px;
                    max-width: 5%;
                    position : relative;
                    margin-top: -15px;
                    margin: 2px;
                }
                
                #cell-exercise{
                    position : relative;
                    
                }
                
                #cell-tasks{
                    position : relative;
                    width: 93%;
                    margin-left: 20px!important;
                }
                
                #cell-buttons{
                    width:5%;
                    padding-top: 5px;
                }
                    
                
                #exerciseBlock, #tasksBlock, .detailBody{
                    height:100%;
                    
                }
                
                #exerciseBody, #tasksBody, .detailBody{
                    padding:5px;
                }
                
                #exerciseHeader, #tasksHeader, .detailHeader{
                    /* box-shadow: 2px 2px 1px #555; */
                    padding:1px 5px;
                    margin-bottom: 5px!Important;
                }
                
                #stepsTable tr td, #tasksTable tr td{
                    vertical-align:top;
                }
                
                body{
                    margin-top: 0px!important;
                }
                
                #detailsModal, #detailsModal_Task, #detailsModal_ex{
                    margin:0px!important;
                    left:20%!important;
                    width:60%!important;
                }
                
                .exerciseBody_QuickView{
                    position: fixed!important;
                    top: 50px;
                    left: 0px;
                    float: left;
                    max-width: 80%;
                    z-index: 500;
                }
                
                .exerciseBody_QuickView #exerciseBody{
                    border: 4px double #3F86A1;
                    background-color:#FAFCFC!Important;
                    z-index: 500;
                    overflow-y: auto;
                    max-height: 400px;
                    border-radius: 10px;
                }
                
                .exerciseBody_QuickView .exercisePuller{
                    background-color: #3F86A1!Important;
                    z-index: 500;
                    border: 6px double #FFF;
                    padding: 1px 5px;
                    padding-left: 10px;;
                    border-top-right-radius: 10px;
                    border-bottom-right-radius: 10px;
                    margin-left: -8px;
                    border-left: 0px solid #FFF;
                    box-shadow: 4px 5px 6px #888;
                }
            
                #exerciseBody_td div.well {
                    background-color: #3F86A1!Important;
                    border: 6px double #FFF;
                    border-bottom-right-radius: 10px;
                    margin-left: -8px;
                    box-shadow: 4px 5px 6px #888;
                }
                
                
                .tooltipster-content{
                    max-width: 200px;
                    background-color: #FFF;
                    border: 1px solid #888 !Important;
                    color: #000;
                }
                
                .btn-toolbar{
                    margin: 0px!important;
                }
                
                .hiddenData{
                    height: 30px;
                    text-overflow: ellipsis;
                    overflow: hidden;
                }
                
                img{
                    width: 80%;
                }
                
                #tasksTable{
                    border-top: 1px solid #888;
                }
                
            </style>
            
            <!--
            <div class="navbar navbar-fixed-top">
                <div class="navbar-inner">
                    <a class="brand" href="#">{!pageHeader}</a>
                    <ul class="nav pull-right">
                        <li><a href="javascript:toggleUpperPane()"><i class="icon-tasks"/></a></li>
                    </ul>
                </div>
            </div>
            -->
            
            
            
            <apex:outputPanel id="mainELearnPanel" layout="block">
                <div id="upperDiv" class="upperSection">
                    <table id="upperSectionFrameTable" style="width:100%">
                        <tr>
                            <!-- cell containing the logo -->
                            <td id="cell-logo">
                                <img src="{!$Resource.eLearningLogo}"/>
                            </td>
                            
                            <!-- cell contianing the task -->
                            <td id="cell-exercise">
                                
                                <!-- quickview box -->
                                <div>
                                    <div class="exerciseBody_QuickView">
                                        <div id="exercisePuller_ext" class="exercisePuller well" onclick="toggleQuickView()">
                                            <b style="color:#FFF">Task {!currentTaskSequence} of {!exercise.Tasks__r.size}</b><i class="icon-chevron-right icon-white"/>
                                        </div>
                                        <div id="quickView_table_div"  style="display:none">
                                            <table class="quickView_table">
                                                <tr>
                                                    <td id="exerciseBody_td" >
                                                        <div class="well">
                                                            <!-- <div class="btn-toolbar">
                                                                <div class="btn-group">
                                                                    <apex:repeat value="{!exercise.Tasks__r}" var="st">
                                                                        <a class="counter btn btn-mini {!IF(st.Sequence__c == currentTaskSequence, IF(tasksMap[st.id].isValid != null && NOT(tasksMap[st.id].isValid) && (NOT(tasksMap[st.id].isReset) || tasksMap[st.id].isReset = null), 'btn-danger','btn-primary'),IF(st.Sequence__c < currentTaskSequence, 'btn-info',''))}" title="<div><b>Task {!st.Sequence__c}</b> <span class='pull-right'>{!st.Status_Image__c}</span><br/><br/><p>{!st.Body__c}</b></div>">{!st.Sequence__c}</a>
                                                                    </apex:repeat>
                                                                </div>
                                                            </div>
                                                            -->
                                                            <div id="exerciseBody">
                                                                <strong class="lead">Objective :</strong>
                                                                <span class="badge badge-info pull-right">
                                                                    <a href="#detailsModal_ex" role="button" data-toggle="modal">
                                                                       <i title="Exercise Description" class="icon-comment icon-white"/>
                                                                    </a>
                                                                </span>    
                                                                <p style="padding: 15px;"><apex:outputField value="{!exercise.Summary__c}"/></p>
                                                                <table id="tasksTable">
                                                                    <apex:repeat value="{!exercise.Tasks__r}" var="st">
                                                                        <tr>
                                                                            <td>
                                                                                <apex:outputPanel rendered="{!tasksMap[st.id].isValid != null && tasksMap[st.id].isValid}">
                                                                                    <i class="icon-check"/>
                                                                                </apex:outputPanel>
                                                                                <apex:outputPanel rendered="{!tasksMap[st.id].isValid != null && NOT(tasksMap[st.id].isValid) && (NOT(tasksMap[st.id].isReset) || tasksMap[st.id].isReset = null)}">
                                                                                    <a href="#errorModal" data-toggle="modal" onclick="getErrorsforTask('{!tasksMap[st.id].messages}');"><i class="icon-warning-sign"/></a>
                                                                                </apex:outputPanel>
                                                                                <apex:outputPanel rendered="{!(st.Sequence__c >= currentTaskSequence && tasksMap[st.id].isValid = null) || tasksMap[st.id].isReset}">
                                                                                    <span>{!st.Sequence__c}.&nbsp;</span>
                                                                                </apex:outputPanel>
                                                                            </td>
                                                                            <td class="{!IF(st.id == currentTaskId, 'currentTaskRow',IF(st.Sequence__c < currentTaskSequence, 'completedTaskRow', ''))}"><apex:outputField value="{!st.Body__c}"/></td>
                                                                            <td width="40px" style="padding:5px;"><apex:outputField styleClass="pull-right" value="{!st.Status_Image__c}"/>&nbsp;</td>
                                                                            <td width="150px" style="padding:5px;">
                                                                                <apex:outputPanel layout="block" rendered="{!st.Sequence__c == currentTaskSequence}">
                                                                                    <div class="btn-toolbar pull-right">
                                                                                        <div class="btn-group">
                                                                                            <a class="btn btn-mini btn-warning" onclick="getHintForTask();" href="#hint" role="button" data-toggle="modal">
                                                                                                <i title="hint" class="icon-question-sign icon-white"/>
                                                                                            </a>
                                                                                            <a class="btn btn-mini btn-primary" href="#detailsModal_Task" role="button" data-toggle="modal">
                                                                                               <i title="detail" class="icon-info-sign icon-white"/>
                                                                                            </a>
                                                                                        </div>
                                                                                        <div class="btn-group">
                                                                                            <a href="#" class="btn btn-mini btn-danger" onclick="prevTaskAndReset()"><i class="icon-backward icon-white"/>&nbsp; Reset</a>
                                                                                        </div>
                                                                                        <!-- <span class="label label-info pull-right" onclick="nextTask()">&nbsp;<i class="icon-forward icon-white"/></span> -->
                                                                                    </div>
                                                                                </apex:outputPanel>
                                                                            </td>
                                                                        </tr>
                                                                    </apex:repeat>
                                                                </table>
                                                            </div>
                                                            <br/>
                                                            <div class="exerciseButtonClass">
                                                                <button class="btn btn-mini btn-danger" onclick="rollBack();">Reset Exam</button>
                                                                <button class="btn btn-mini btn-success pull-right">Submit Exam</button>
                                                            </div>
                                                            
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <div id="exercisePuller_int" class="exercisePuller well" onclick="toggleQuickView()" style="display:none">
                                                            <i class="icon-chevron-left icon-white"/>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                            
                                        </div>
                                    </div>
                                </div>  
                            </td>
                            
                            <!-- cell contianing the current step of the task -->
                            <td id="cell-tasks">
                                <apex:outputPanel id="stepPanel" >
                                    <div id="tasksBlock">
                                        
                                        <div id="tasksHeader" class="well well-small">
                                            <table width="100%">
                                                <tr style="vertical-align:middle">
                                                    <td width="50px">
                                                         <b>Step</b>      
                                                    </td>
                                                    <td>
                                                        <div style="width:100%">
                                                            <div class="btn-group">
                                                                <apex:repeat value="{!currentTask.Steps__r}" var="st">
                                                                    <a class="counter btn btn-mini {!IF(st.Sequence__c == currentStepSequence, 'btn-primary',IF(st.Sequence__c < currentStepSequence, 'btn-info',''))}" title="<div><b>Step {!st.Sequence__c}</b><br/><br/><p>{!st.Body__c}</b></div>">{!st.Sequence__c}</a>
                                                                </apex:repeat>
                                                            </div>
                                                            
                                                            <span class="pull-right">
                                                                <a onclick="getHint('{!currentStepId}');" href="#hint" role="button" data-toggle="modal">
                                                                    <i title="hint" class="icon-question-sign"/>
                                                                </a>
                                                                <a href="#detailsModal" role="button" data-toggle="modal">
                                                                    <i title="detail" class="icon-info-sign"/>
                                                                </a>
                                                            </span>
                                                            
                                                        </div>
                                                    </td>
                                                </tr>
                                            </table>
                                                                                     
                                            
                                        </div>
                                        
                                        <div id="tasksBody">
                                            <apex:outputPanel rendered="{!currentStep != null && stepsMap[currentStep.id].messages.size > 0}">
                                                <!-- Modal -->
                                                    <div id="messageModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="messageModalLabel" aria-hidden="true">
                                                        <div class="modal-header">
                                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                                            <h3 id="messageModalLabel">Message</h3>
                                                        </div>
                                                        <div class="modal-body">
                                                            <apex:repeat value="{!stepsMap[currentStep.id].messages}" var="msg" rendered="{!currentStep != null}">
                                                                <p><apex:outputText escape="false" value="{!msg}" /></p>
                                                            </apex:repeat>
                                                        </div>
                                                        <div class="modal-footer">
                                                            <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
                                                            {!stepsMap[currentStep.id].isValid}
                                                            <button class="btn btn-primary" onClick="continueStepAndClose();">Continue</button>
                                                        </div>
                                                    </div>
                                            </apex:outputPanel>
                                            
                                            <apex:outputPanel rendered="{!currentStep != null}">
                                            <script>var final_score=0;
                                                    var deduction_points=0;
                                                    document.getElementById("pageId:formId:hiddeninput").value =deduction_points;
                                            </script>
                                            <table id="stepsTable" width="100%">
                                                <tr>
                                                    <td><apex:outputField value="{!currentStep.Body__c}"/></td>
                                                    <td width="150px">
                                                        <center class="pull-right">
                                                            <button class="btn btn-mini btn-info" onclick="nextStep()">Next Step</button>
                                                            <button class="btn btn-mini btn-danger" onclick="prevStepAndReset()">Reset</button>
                                                        </center>
                                                    </td>
                                                </tr>
                                            </table>
                                                        
                                            </apex:outputPanel>
                                        </div>
                                                        
                                        <!-- 
                                        <div class="taskButtonClass">
                                            <a class="btn btn-mini btn-info" onclick="getHint('{!currentStepId}');" href="#hint" role="button" data-toggle="modal">Hint</a>
                                            <a class="btn btn-mini btn-info" href="#detailsModal" role="button" data-toggle="modal">Details</a>
                                        </div>
                                        -->
                                    </div>
                                    
                                    <script>
                                        $(function(){
                                            $("i").tooltip();
                                            $('.counter').tooltipster({
                                                interactive: true,
                                                position: 'bottom-left'
                                            });
                                        });
                                    </script>
                                                
                                </apex:outputPanel>
                            </td>
                            
                            <!-- cell containing the buttons on the right most end -->
                            <!-- <td>
                                <center>
                                    <button class="eLearnButton btn btn-danger" onclick="rollBack();">Reset Data</button>
                                    <button class="eLearnButton btn btn-success">Submit Work</button>
                                </center>
                                
                            </td> -->
                        </tr>
                    </table>
                </div>
            
                <apex:form id="formId" style="display:none">
                    <apex:actionFunction name="nextTask" action="{!changeToNextTask}" reRender="mainELearnPanel, detailsModalPanel, detailsModalPanel_Task" oncomplete="resizeDiv();"/>
                    <apex:actionFunction name="nextStep" action="{!changeToNextStep}" reRender="mainELearnPanel, detailsModalPanel, detailsModalPanel_Task" oncomplete="showMessages(); resizeDiv();"/>
                    <apex:actionFunction name="continueStep" action="{!changeToNextStep}" reRender="mainELearnPanel, detailsModalPanel, detailsModalPanel_Task" oncomplete="resizeDiv();" />
                    <apex:actionFunction name="rollBack" action="{!rollBacktoFirst}"  reRender="mainELearnPanel, detailsModalPanel, detailsModalPanel_Task"/>
                    <apex:actionFunction name="prevTaskAndReset" action="{!changeToprevTask}"  reRender="mainELearnPanel, detailsModalPanel, detailsModalPanel_Task" oncomplete="resizeDiv();"/>
                    <apex:actionFunction name="prevStepAndReset" action="{!changeToprevStep}"  reRender="stepPanel, mainELearnPanel, detailsModalPanel, detailsModalPanel_Task" oncomplete="resizeDiv();"/>
                    <apex:actionFunction name="stopVideo" reRender="detailsModalPanel, detailsModalPanel_Task, detailsModalPanel_ex"/>
                    <apex:inputhidden value="{!hintCount}" id="finalHintCount" />
                    <apex:inputHidden id="hiddeninput" value="{!points_to_deduct}"/>
                </apex:form>
            </apex:outputPanel>
                
            <center style="width: 100%">
                <div class="workSpace">
                    <iframe src="/home/home.jsp" style="width:99%; height:100%"/>
                </div>
            </center>
                    
            
            
            <!-- modal window for Exercise detail -->
            <div id="detailsModal_ex" class="modal hide fade" aria-labelledby="detailsModalLabel_ex" data-backdrop="static" data-keyboard="false" aria-hidden="true">
                <div class="modal-header">
                    <h3 id="detailsModalLabel_ex">Details</h3>
                </div>
                <div class="modal-body" id="detailsModalBody_ex">
                    <apex:outputPanel id="detailsModalPanel_ex">
                        
                        <apex:outputPanel rendered="{!exercise != null}">
                            <div class="well well-small" onclick="$('#descBody_ex').slideToggle();">Description</div>
                            <div id="descBody_ex" class="detailBody">
                                <apex:outputField value="{!exercise.Body__c}"/>
                            </div>
                        </apex:outputPanel>
                        <br/>
                        <apex:outputPanel rendered="{!exercise.VideoID__c != null}">
                            <div class="well well-small" onclick="$('#videoBody_ex').slideToggle();">Video</div>
                            <div id="videoBody_ex" class="detailBody">
                                <center>
                                <iframe id="videoPlayer" width="640px" height="360px" src="http://www.youtube.com/v/{!exercise.VideoID__c}?version=3&enablejsapi=1" frameborder="0" allowfullscreen="true"></iframe>
                                </center>
                            </div>
                        </apex:outputPanel> 
                        <br/>
                        <apex:outputPanel rendered="{!exercise.Attachments.size>0}">
                            <div class="well well-small" onclick="$('#stepImgCarousel_ex').slideToggle();">Images</div>
                            <br/> 
                            <div id="stepImgCarousel_ex" class="carousel slide detailBody">
                                <div class="carousel-inner">
                                    <!-- <div class="item active">
                                        <center style="min-height:250px"><apex:outputField value="{!currentStep.Body__c}"/> </center>
                                    </div> -->
                                    <apex:repeat value="{!exercise.Attachments}" var="att">
                                        <div class="item">
                                            <center>
                                                <apex:image style="max-height:250px ;max-width:500px" value="{!URLFOR($Action.Attachment.Download, att.id)}"/>
                                            </center> 
                                        </div>
                                    </apex:repeat>
                                </div>
                                <a class="carousel-control left" href="#stepImgCarousel_ex" data-slide="prev">&lsaquo;</a>
                                <a class="carousel-control right" href="#stepImgCarousel_ex" data-slide="next">&rsaquo;</a>
                            </div>
                            
                            <!-- script to start the carousel on its own -->
                            <script>
                                $('#stepImgCarousel_ex').carousel('next');
                            </script>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!(exercise.Attachments == null || exercise.Attachments.size == 0)  && exercise.VideoID__c == null &&  exercise.Body__c == null}">
                            <center>No Detail Available For This Exercise</center>
                            <br/>
                        </apex:outputPanel>
                                           
                    </apex:outputPanel>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-success" data-dismiss="modal" aria-hidden="true" onclick="stopVideo()">Close</button>
                </div>

            </div>
            
            <div id="detailsModal" class="modal hide fade" aria-labelledby="detailsModalLabel" data-backdrop="static" data-keyboard="false" aria-hidden="true">
                <div class="modal-header">
                    <h3 id="detailsModalLabel">Details</h3>
                </div>
                <div class="modal-body" id="detailsModalBody">
                    <apex:outputPanel id="detailsModalPanel">
                        
                        <apex:outputPanel rendered="{!currentStep.Description__c != null}">
                            <div class="well well-small" onclick="$('#descBody').slideToggle();">Description</div>
                            <div id="descBody" class="detailBody">
                                <apex:outputField value="{!currentStep.Description__c}"/>
                            </div>
                        </apex:outputPanel>
                        <br/>
                        <apex:outputPanel rendered="{!currentStep.VideoID__c != null}">
                            <div class="well well-small" onclick="$('#videoBody').slideToggle();">Video</div>
                            <div id="videoBody" class="detailBody">
                                <center>
                                <iframe id="videoPlayer" width="640px" height="360px" src="http://www.youtube.com/v/{!currentStep.VideoID__c}?version=3&enablejsapi=1" frameborder="0" allowfullscreen="true"></iframe>
                                </center>
                            </div>
                        </apex:outputPanel> 
                        <br/>
                        <apex:outputPanel rendered="{!listOfStepAttach.size>0}">
                            <div class="well well-small" onclick="$('#stepImgCarousel').slideToggle();">Images</div>
                            <br/> 
                            <div id="stepImgCarousel" class="carousel slide detailBody">
                                <div class="carousel-inner">
                                    <!-- <div class="item active">
                                        <center style="min-height:250px"><apex:outputField value="{!currentStep.Body__c}"/> </center>
                                    </div> -->
                                    <apex:repeat value="{!listOfStepAttach}" var="att">
                                        <div class="item">
                                            <center>
                                                <apex:image style="max-height:250px ;max-width:500px" value="{!URLFOR($Action.Attachment.Download, att.id)}"/>
                                            </center> 
                                        </div>
                                    </apex:repeat>
                                </div>
                                <a class="carousel-control left" href="#stepImgCarousel" data-slide="prev">&lsaquo;</a>
                                <a class="carousel-control right" href="#stepImgCarousel" data-slide="next">&rsaquo;</a>
                            </div>
                            
                            <!-- script to start the carousel onm its own -->
                            <script>
                                $('.carousel').carousel('next');
                            </script>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!listOfStepAttach.size == 0  && currentStep.VideoID__c == null &&  currentStep.Description__c == null}">
                            <center>No Details Available For This Step</center>
                            <br/>
                        </apex:outputPanel>
                                           
                    </apex:outputPanel>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-success" data-dismiss="modal" aria-hidden="true" onclick="stopVideo()">Close</button>
                </div>

            </div>
            
            <!-- modal window for TASK detail -->
            <div id="detailsModal_Task" class="modal hide fade" aria-labelledby="detailsModalLabel_Task" data-backdrop="static" data-keyboard="false" aria-hidden="true">
                <div class="modal-header">
                    <h3 id="detailsModalLabel_Task">Details</h3>
                </div>
                <div class="modal-body" id="detailsModalBody_Task">
                    <apex:outputPanel id="detailsModalPanel_Task">
                        
                        <apex:outputPanel rendered="{!currentTask.Description__c != null}">
                            <div class="well well-small" onclick="$('#descBody').slideToggle();">Description</div>
                            <div id="descBody" class="detailBody">
                                <apex:outputField value="{!currentTask.Description__c}"/>
                            </div>
                        </apex:outputPanel>
                        <br/>
                        <apex:outputPanel rendered="{!currentTask.Video_ID__c != null}">
                            <div class="well well-small" onclick="$('#videoBody_Task').slideToggle();">Video</div>
                            <div id="videoBody_Task" class="detailBody">
                                <center>
                                <iframe id="videoPlayer_Task" width="640px" height="360px" src="http://www.youtube.com/v/{!currentTask.Video_ID__c}?version=3&enablejsapi=1" frameborder="0" allowfullscreen="true"></iframe>
                                </center>
                            </div>
                        </apex:outputPanel> 
                        <br/>
                        <apex:outputPanel rendered="{!currentTask.Attachments.size>0}">
                            <div class="well well-small" onclick="$('#stepImgCarousel_Task').slideToggle();">Images</div>
                            <br/> 
                            <div id="stepImgCarousel_Task" class="carousel slide detailBody">
                                <div class="carousel-inner">
                                    <!-- <div class="item active">
                                        <center style="min-height:250px"><apex:outputField value="{!currentStep.Body__c}"/> </center>
                                    </div> -->
                                    <apex:repeat value="{!currentTask.Attachments}" var="att">
                                        <div class="item">
                                            <center>
                                                <apex:image style="max-height:250px ;max-width:500px" value="{!URLFOR($Action.Attachment.Download, att.id)}"/>
                                            </center> 
                                        </div>
                                    </apex:repeat>
                                </div>
                                <a class="carousel-control left" href="#stepImgCarousel_Task" data-slide="prev">&lsaquo;</a>
                                <a class="carousel-control right" href="#stepImgCarousel_Task" data-slide="next">&rsaquo;</a>
                            </div>
                            
                            <!-- script to start the carousel onm its own -->
                            <script>
                                $('#stepImgCarousel_Task').carousel('next');
                            </script>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!(currentTask.Attachments == null || currentTask.Attachments.size == 0)  && currentTask.Video_ID__c == null &&  currentTask.Description__c == null}">
                            <center>No Details Available For This Task</center>
                            <br/>
                        </apex:outputPanel>
                                           
                    </apex:outputPanel>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-success" data-dismiss="modal" aria-hidden="true" onclick="stopVideo()">Close</button>
                </div>
            </div>
            
            
            <!-- *** modal window for Errors *** -->
            <div class="modal hide fade" id="errorModal" aria-labelledby="modallabel" aria-hidden="true">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="icon-remove"></i></button>
                        <h3 id="modaldlabel">Error</h3>
                </div>
                <div class="modal-body" id="errorBody">
                </div>
                <div class="modal-footer">
                    <button class="btn btn-success" data-dismiss="modal" aria-hidden="true">Ok</button>
                </div>

            </div>
            <!-- *** END  modal window for Error *** -->
            
            
            <!-- *** modal window for hint *** -->
            <div class="modal hide fade" id="hint" aria-labelledby="modallabel" aria-hidden="true">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="icon-remove"></i></button>
                        <h3 id="modaldlabel">Hint</h3>
                </div>
                <div class="modal-body" id="hintBody">
                </div>
                <div class="modal-footer">
                    <button class="btn btn-success" data-dismiss="modal" aria-hidden="true">Ok</button>
                </div>

            </div>
            <!-- *** END  modal window for hint *** -->
            
            <!-- script for querying hints -->
            <script src="/soap/ajax/27.0/connection.js" type="text/javascript"></script>
            <script src="/soap/ajax/27.0/apex.js" type="text/javascript"></script>
            <script>
                
                //this will bring the upper pane in focus, if already in focus it will hide/show the pane 
                function toggleUpperPane(){
                    if(window.pageYOffset < 100){
                        $('#upperDiv').slideToggle(); 
                    }else{
                        $("html, body").animate({ scrollTop: 0 });
                        if($('#upperDiv').css('display') == 'none'){
                            $('#upperDiv').slideToggle(); 
                        }
                    }
                }
                
                function getErrorsforTask(messages){
                    var msg = messages.replace('[','').replace(']','');
                    
                    $("#errorBody").empty();
                    
                    var bdy = $("#errorBody").append('<p class="text-error">'+msg+'</p>');
                    
                }
                
                //function to get the hint corresponding to a particular step
                //
                // SPR - 6/26/13 - Modified this function to pass in current step to fix problem with hints not reflecting
                //                    step changes.  Remember that apex variable notation is only executed at run time for
                //                    the code it is in.  Since this was rendered once when the page was first painted, 
                //                    it was always set to the first step.
                //
                
                function getHint(currentStepId)
                {
                
                    sforce.connection.sessionId = "{!$Api.Session_ID}";
                    //sessionStorage.setItem("sequenceCount_step",-1);
                    var seqCnt = sessionStorage.getItem("sequenceCount_step");
                    var oldStepId = sessionStorage.getItem("stepId");
                    //sessionStorage.setItem("stepId",'{!currentStepId}');
                    sessionStorage.setItem("stepId",currentStepId);
                    //if(oldStepId != '{!currentStepId}')
                    if(oldStepId != currentStepId)
                    {
                        seqCnt = '';
                    }
                    if(seqCnt == NaN || seqCnt == undefined)
                        seqCnt = '';

                    console.log(seqCnt);

                    //Code snippet to store the hint count (or) in other words the number of hints utilised by the user.
                    var hintCount = 0;
                    if(sessionStorage.getItem("currHintCount") != null && sessionStorage.getItem("currHintCount") != '')
                        hintCount = sessionStorage.getItem("currHintCount");
                    
                    var scoreRecords = sforce.connection.query('Select Id,Total_points__c from Step__c where Id = \'' + currentStepId + '\'');
                    var scoreResults = scoreRecords.getArray("records");
                    console.log('score-- '+scoreResults);
                    var prevScore  = 0;
                    if(scoreResults.length != 0)
                        prevScore = scoreResults[0].Total_points__c;
                    
                    /***************** Hint Count code end *****************************/


                    //var queryStr = 'Select Id,Sequence__c,Body__c from Message__c where type__c = \'Hint\' AND Step__c = \'{!currentStepId}\'';
                    var queryStr = 'Select Id,Sequence__c,Body__c from Message__c where type__c = \'Hint\' AND Step__c = \'' + currentStepId + '\'';     
                    
                    if(sessionStorage.getItem("sequenceCount_step") != null && sessionStorage.getItem("sequenceCount_step") != '')
                    {
                         
                         var seqArray = new Array();
                         seqArray = seqCnt.split(',');
                         var seqNumberArray = new Array();
                         for(var a=0;a<seqArray.length;a++)
                         {
                            seqNumberArray.push(Number(seqArray[a]));
                         }
                         queryStr += ' and Sequence__c NOT in (' + seqNumberArray.join(',') + ') ';
                    }

                    queryStr +=' order by Sequence__c asc limit 1';
                    console.log('quer-- '+queryStr);
                    //alert("query : " + queryStr);
                    var hintQuery = sforce.connection.query(queryStr);
                    var hintResults = hintQuery.getArray("records");
                    var hintMessage = '';


                    if(hintResults.length == 0)
                    {
                        hintMessage = 'Sorry! All out of hints';
                    }
                    else
                    {
                        hintMessage = hintResults[0].Body__c;
                        hintCount++;
                        var deduction_result = sforce.connection.query("select name,points_to_deduct__c from scoreDeduction__c where Name=\'"+hintCount+"\'");
                        var deduction_result_records=deduction_result.getArray("records");
                        var points_to_deduct=deduction_result_records[0].points_to_deduct__c;
                        deduction_points=parseInt(deduction_points)+parseInt(points_to_deduct);
                        document.getElementById("pageId:formId:hiddeninput").value =deduction_points;
                        if(hintCount==1)
                            final_score=parseInt(prevScore)-parseInt(points_to_deduct);
                        else
                            final_score=parseInt(final_score)-parseInt(points_to_deduct);
                        sessionStorage.setItem("currHintCount",hintCount);
                        
                        /*
                        if(hintCount == 1)
                        {
                            hintMessage += '</br></br></br><span style="font-family:georgia;color:grey">Note: You have used <span style="font-size:1.2em">'+ hintCount + ' </span>hint for this step, Points Lost: <span style=\"color:red;font-weight:bold;font-size:1.2em;\">1</span> Points remaining: <span style=\"color:green;font-weight:bold;font-size:1.2em;\">11</span>';
                        }
                        else if(hintCount == 2)
                        {
                            hintMessage += '</br></br></br><span style="font-family:georgia;color:grey">Note: You have used <span style="font-size:1.2em">'+ hintCount + ' </span> hints for this step, Points Lost: <span style=\"color:red;font-weight:bold;font-size:1.2em;\">4</span> Points remaining: <span style=\"color:green;font-weight:bold;font-size:1.2em;\">8</span>';
                        }
                        else if(hintCount == 3)
                        {
                            hintMessage += '</br></br></br><span style="font-family:georgia;color:grey">Note: You have used <span style="font-size:1.2em">'+ hintCount + '</span> hints for this step, Points Lost: <span style=\"color:red;font-weight:bold;font-size:1.2em;\">9</span>  Points remaining: <span style=\"color:green;font-weight:bold;font-size:1.2em;\">3</span></span>';
                        }
                        */
                        hintMessage += '</br></br></br><span style="font-family:georgia;color:grey">Note: You have used <span style="font-size:1.2em">'+ hintCount + ' </span>hint for this step, Points Lost: <span style=\"color:red;font-weight:bold;font-size:1.2em;\">'+points_to_deduct+'</span> Points remaining: <span style=\"color:green;font-weight:bold;font-size:1.2em;\">'+final_score+'</span>';
                        /*
                        if(prevScore != -50)
                           hintMessage +=  '</br><span style="font-family:georgia;color:grey"> Previous Score for this step: <span style=\"font-weight:bold;font-size:1.2em;\">'+Number(prevScore)+'</span>';
                        */
                        var updatedSeq = seqCnt + ','+hintResults[0].Sequence__c;
                        sessionStorage.setItem("sequenceCount_step",updatedSeq);
                    }
                    console.log(hintCount);
                    document.getElementById("pageId:formId:finalHintCount").value = hintCount;
                    $("#hintBody").html(hintMessage);
                }
                
                //function to get the hint corresponding to a particular task
                function getHintForTask()
                {
                    sforce.connection.sessionId = "{!$Api.Session_ID}";
                    var seqCnt_task = sessionStorage.getItem("sequenceCount_task");
                    var oldTaskId = sessionStorage.getItem("taskId");
                    sessionStorage.setItem("taskId",'{!currentTaskId}');
                    
                    if(oldTaskId != '{!currentTaskId}')
                    {
                        seqCnt_task = '';
                    }
                    if(seqCnt_task == NaN || seqCnt_task == undefined)
                        seqCnt_task = '';

                    console.log(seqCnt_task);
                    var queryStr_task = 'Select Id,Sequence__c,Body__c from Message__c where Task__c = \'{!currentTaskId}\' AND Type__c = \'Hint\'';

                    if(sessionStorage.getItem("sequenceCount_task") != null && sessionStorage.getItem("sequenceCount_task") != '')
                    {
                         
                         var seqArray_task = new Array();
                         seqArray_task = seqCnt_task.split(',');
                         var seqNumberArray_task = new Array();
                         for(var a=0;a<seqArray_task.length;a++)
                         {
                            seqNumberArray_task.push(Number(seqArray_task[a]));
                         }
                         queryStr_task += ' and Sequence__c NOT in (' + seqNumberArray_task.join(',') + ') ';
                    }

                    queryStr_task +=' order by Sequence__c asc limit 1';
                    var hintQuery_task = sforce.connection.query(queryStr_task);
                    var hintResults_task = hintQuery_task.getArray("records");
                    var hintMessage_task = '';

                    if(hintResults_task.length == 0)
                    {
                        hintMessage_task = 'Sorry! All out of hints';
                    }
                    else
                    {
                        hintMessage_task = hintResults_task[0].Body__c;
                        var updatedSeq_task = seqCnt_task + ','+hintResults_task[0].Sequence__c;
                        sessionStorage.setItem("sequenceCount_task",updatedSeq_task);
                    }

                    $("#hintBody").html(hintMessage_task);
                }
                
                function showMessages(){
                    //alert("Message");
                    $('#messageModal').modal('show');
                }
                
                function continueStepAndClose(){
                    $('#messageModal').modal('hide');
                    continueStep();
                }
                
                
                
                <!-- quickview script -->
                function toggleQuickView(){
                    
                    if($("#exercisePuller_ext").css('display') == 'none'){
                        $('.exerciseBody_QuickView #quickView_table_div').toggle('slide', {direction: 'left'}, 500, function(){$(".exercisePuller").toggle();});
                    }else{
                        $(".exercisePuller").toggle();
                        $('.exerciseBody_QuickView #quickView_table_div').toggle('slide', {direction: 'left'}, 500);
                    }
                }

                <!-- toggle exercise view -->
                function toggleExercise(){
                    if($("#exercisetext_p").css('height') != '30px'){
                        $("#exercisetext_p").addClass('hiddenData');
                    }else{
                        $("#exercisetext_p").removeClass('hiddenData');
                    }
                }
                
            </script>

        </apex:page>